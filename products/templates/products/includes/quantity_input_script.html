<script>
/* -----------------------------
   ENABLE / DISABLE BUTTONS
------------------------------*/
function updateButtons(itemId) {
    const input = $(`#id_qty_${itemId}`);
    const value = parseInt(input.val());

    $(`#decrement-qty_${itemId}`).prop('disabled', value <= 1);
    $(`#increment-qty_${itemId}`).prop('disabled', value >= 99);
}

/* -----------------------------
   INITIALIZE BUTTON STATES
------------------------------*/
$('.qty_input').each(function () {
    const itemId = $(this).data('item_id');
    updateButtons(itemId);
});

/* -----------------------------
   INPUT VALIDATION (manual typing)
------------------------------*/
$('.qty_input').on('input', function () {
    let value = parseInt($(this).val());

    if (isNaN(value) || value < 1) value = 1;
    if (value > 99) value = 99;

    $(this).val(value);

    const itemId = $(this).data('item_id');
    updateButtons(itemId);
});

/* -----------------------------
   INCREMENT BUTTON
------------------------------*/
$('.increment-qty').click(function (e) {
    e.preventDefault();
    const itemId = $(this).data('item_id');
    const input = $(`#id_qty_${itemId}`);

    let value = parseInt(input.val());
    if (value < 99) {
        value += 1;
        input.val(value);
    }

    updateButtons(itemId);
});

/* -----------------------------
   DECREMENT BUTTON
------------------------------*/
$('.decrement-qty').click(function (e) {
    e.preventDefault();
    const itemId = $(this).data('item_id');
    const input = $(`#id_qty_${itemId}`);

    let value = parseInt(input.val());
    if (value > 1) {
        value -= 1;
        input.val(value);
    }

    updateButtons(itemId);
});
</script>
